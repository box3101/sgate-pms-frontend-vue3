import P from"./DYEav3bl.js";import G from"./DznjmlHz.js";import{r as p,g as z,a4 as E,c as n,o as s,a as o,n as d,a7 as u,t as h,b as v,G as L,w as g,B as w,d as b,x as M}from"./DK13UrN4.js";import"./BXT2azkc.js";const q={class:"flex items-center justify-between gap-5"},F={class:"flex items-center gap-10"},J={class:"flex items-center gap-10"},K={class:"heading-4"},Q={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},W={class:"flex items-center gap-5"},X={key:0,class:"table-actions"},Y={class:"button-group flex items-center gap-5"},Z={key:0,class:"excel-controls flex items-center gap-5 mr-5"},_={key:0,class:"sort-mode-message"},ee={key:1,class:"empty-state"},te={class:"empty-content"},le={class:"empty-title"},ae={class:"empty-description"},oe={key:0,class:"empty-actions"},se={key:2,class:"table-scroll-container"},ne={key:0},de={key:1,class:"sticky-header"},ie={key:2},re={key:3},ue={key:0},ce={key:1,class:"sticky-header"},fe={key:2},ye={key:3},me={key:4},we={__name:"UiTable",props:{title:{type:String,default:""},bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:t=>["small","medium","large"].includes(t)},layout:{type:String,default:"",validator:t=>["vertical","horizontal"].includes(t)},isThLeft:{type:Boolean,default:!1},alignTop:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},fixHeader:{type:Boolean,default:!1},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},canAddRow:{type:Boolean,default:!0},canSave:{type:Boolean,default:!0},canAddSortableButton:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1},emptyTitle:{type:String,default:"데이터가 없습니다"},emptyDescription:{type:String,default:"표시할 항목이 없습니다."},forceEmpty:{type:Boolean,default:!1},rowClickable:{type:Boolean,default:!1},rowClickCursor:{type:Boolean,default:!1},cursorPointer:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","row-click","order-changed","add-row"],setup(t,{emit:O}){const f=O,r=t,i=p([]),c=p(r.sortableOption),k=p(!1),m=p(null),B=z(()=>r.forceEmpty||!r.modelValue||r.modelValue.length===0),S=z(()=>r.modelValue.length>0&&i.value.length===r.modelValue.length),D=()=>{S.value?i.value=[]:i.value=[...r.modelValue]},$=e=>{if(c.value)return;const l=i.value.findIndex(a=>a===e);l===-1?i.value.push(e):i.value.splice(l,1)},C=e=>i.value.includes(e),H=()=>({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...r.defaultRowData}),R=()=>{const e=H(),l=[...r.modelValue,e];f("update:modelValue",l),f("row-added",e),f("add-row",e)},U=()=>{if(i.value.length===0)return;const e=[...i.value],l=r.modelValue.filter(a=>!i.value.includes(a));f("update:modelValue",l),i.value=[],f("row-deleted",e)},I=()=>{c.value=!c.value,c.value||(i.value=[])},V=(e,l)=>{if(c.value){m.value=l,k.value=!0,e.dataTransfer.effectAllowed="move";try{const a=e.target.closest("tr");a&&e.dataTransfer.setDragImage(a,0,0)}catch(a){console.warn("드래그 이미지가 이 브라우저에서 지원되지 않습니다",a)}}},A=e=>{c.value&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},x=(e,l)=>{if(!(!c.value||m.value===null)){if(e.preventDefault(),m.value!==l){const a=[...r.modelValue],y=a[m.value];a.splice(m.value,1),a.splice(l,0,y),f("update:modelValue",a),f("order-changed",{from:m.value,to:l,rows:a})}m.value=null,k.value=!1}},T=()=>{m.value=null,k.value=!1},N=(e,l,a)=>{r.rowClickable&&(a.target.closest(".ui-checkbox")||a.target.closest("button")||a.target.closest(".drag-handle")||f("row-click",{row:e,index:l,event:a}))},j=()=>{f("save",r.modelValue),c.value=!1};return E(()=>r.modelValue,()=>{i.value=i.value.filter(e=>r.modelValue.some(l=>l===e))}),E(()=>r.editable,e=>{e||(c.value=!1)}),(e,l)=>{const a=P,y=G;return s(),n("div",{class:w(["ui-table-wrapper",[t.bordered&&"bordered",t.striped&&"striped",t.hover&&"hover",t.size,t.layout,t.scrollable&&"scrollable",k.value&&"dragging",t.editable&&"editable",t.alignTop&&"align-top",t.rowClickCursor&&"row-clickable",t.cursorPointer&&"cursor-pointer"]]),style:M(t.scrollable?{maxHeight:t.maxHeight}:{})},[o("div",{class:w(["section-header",t.fixHeader&&"sticky-header-btn"])},[o("div",q,[o("div",F,[o("div",J,[o("h2",K,h(t.title),1),u(e.$slots,"header-action-left")]),t.gradeRangeControls?(s(),n("div",Q,[o("div",null,[v(a,{label:"구간대 설정"})])])):d("",!0)]),o("div",W,[u(e.$slots,"header-action-right"),t.editable?(s(),n("div",X,[o("div",Y,[t.canAddRow?(s(),L(y,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:R,title:"행 추가"},{default:g(()=>l[0]||(l[0]=[o("i",{class:"icon-md icon-plus icon-black"},null,-1)])),_:1,__:[0]})):d("",!0),v(y,{type:"button",variant:"secondary-line","icon-only":"",onClick:U,disabled:i.value.length===0,title:"선택한 행 삭제"},{default:g(()=>l[1]||(l[1]=[o("i",{class:"icon-md icon-delete"},null,-1)])),_:1,__:[1]},8,["disabled"]),t.canAddSortableButton?(s(),L(y,{key:1,type:"button",variant:"secondary-line","icon-only":"",onClick:I,class:w({active:c.value}),title:"정렬 모드"},{default:g(()=>l[2]||(l[2]=[o("i",{class:"icon-md icon-sort"},null,-1)])),_:1,__:[2]},8,["class"])):d("",!0),t.canSave?u(e.$slots,"action-button",{key:2},()=>[v(y,{type:"button",variant:"primary",onClick:j},{default:g(()=>l[3]||(l[3]=[b("저장")])),_:1,__:[3]})]):d("",!0)])])):d("",!0)]),t.excelControls?(s(),n("div",Z,[v(y,{variant:"secondary-line",size:"medium"},{default:g(()=>[l[4]||(l[4]=o("i",{class:"icon-md icon-excel"},null,-1)),b(" "+h(t.excelDownloadLabel),1)]),_:1,__:[4]}),v(y,{variant:"secondary-line",size:"medium"},{default:g(()=>[l[5]||(l[5]=o("i",{class:"icon-md icon-excel"},null,-1)),b(" "+h(t.excelUploadLabel),1)]),_:1,__:[5]}),u(e.$slots,"header-right-end")])):d("",!0)])],2),c.value&&t.editable?(s(),n("div",_,l[6]||(l[6]=[b(" 행을 드래그하여 순서를 변경할 수 있습니다. "),o("br",null,null,-1),b("완료 후 정렬 버튼을 다시 클릭하세요. ")]))):d("",!0),B.value?(s(),n("div",ee,[u(e.$slots,"empty",{addRow:R,editable:t.editable},()=>[o("div",te,[l[8]||(l[8]=o("div",{class:"empty-icon"},[o("i",{class:"icon-xxl icon-table"})],-1)),o("h3",le,h(t.emptyTitle),1),o("p",ae,h(t.emptyDescription),1),t.editable&&t.canAddRow?(s(),n("div",oe,[v(y,{variant:"primary",onClick:R},{default:g(()=>l[7]||(l[7]=[o("i",{class:"icon-sm icon-plus"},null,-1),b(" 첫 번째 항목 추가 ")])),_:1,__:[7]})])):d("",!0)])])])):t.scrollable?(s(),n("div",se,[o("table",{class:w(["ui-table",{"th-left":t.isThLeft}])},[e.$slots.colgroup?(s(),n("colgroup",ne,[u(e.$slots,"colgroup")])):d("",!0),e.$slots.header&&t.layout!=="horizontal"?(s(),n("thead",de,[u(e.$slots,"header",{selectAll:D,isAllSelected:S.value,editable:t.editable})])):d("",!0),e.$slots.body?(s(),n("tbody",ie,[u(e.$slots,"body",{rows:t.modelValue,selectedRows:i.value,toggleRowSelection:$,isRowSelected:C,handleDragStart:V,handleDragOver:A,handleDrop:x,handleDragEnd:T,handleRowClick:N,sortable:c.value,editable:t.editable})])):d("",!0),e.$slots.footer?(s(),n("tfoot",re,[u(e.$slots,"footer")])):d("",!0)],2)])):B.value?d("",!0):(s(),n("table",{key:3,class:w(["ui-table",{"th-left":t.isThLeft}])},[e.$slots.colgroup?(s(),n("colgroup",ue,[u(e.$slots,"colgroup")])):d("",!0),e.$slots.header&&t.layout!=="horizontal"?(s(),n("thead",ce,[u(e.$slots,"header",{selectAll:D,isAllSelected:S.value,editable:t.editable})])):d("",!0),t.layout==="horizontal"?(s(),n("thead",fe,[u(e.$slots,"header")])):d("",!0),e.$slots.body?(s(),n("tbody",ye,[u(e.$slots,"body",{rows:t.modelValue,selectedRows:i.value,toggleRowSelection:$,isRowSelected:C,handleDragStart:V,handleDragOver:A,handleDrop:x,handleDragEnd:T,sortable:c.value,editable:t.editable})])):d("",!0),e.$slots.footer?(s(),n("tfoot",me,[u(e.$slots,"footer")])):d("",!0)],2))],6)}}};export{we as default};
