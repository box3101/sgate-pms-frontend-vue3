import G from"./C4pfovbT.js";import{r as b,g as x,a4 as K,c as l,o as a,a as o,b as h,d as z,B,n as v,F as k,i as f,x as P,t as S,q as Q,k as g,v as V,m as W}from"./Chvr4NKR.js";const X={class:"edit-ui-table"},Y={class:"table-controls"},Z={key:0,class:"view-controls"},ee={key:1,class:"edit-controls"},te={class:"edit-actions"},le={class:"row-actions"},ae=["disabled"],se={class:"ui-table-wrapper-default"},ne={key:0,style:{width:"40px"}},oe={key:1,style:{width:"30px"}},ue={class:"ui-table-default__header"},de={key:0,class:"checkbox-column"},ie=["checked"],ce={key:1,class:"drag-column"},re=["onDragstart","onDragover","onDrop","draggable"],pe={key:0,class:"checkbox-column"},ve=["checked","onChange"],me={key:1,class:"drag-column"},ye={class:"drag-handle"},he={key:0,class:"cell-content"},_e={key:1,class:"cell-edit"},be=["onUpdate:modelValue","placeholder"],ke=["onUpdate:modelValue","placeholder"],fe=["onUpdate:modelValue","placeholder"],ge=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],De=["value"],Ce={key:0,class:"ui-table-default__empty"},xe=["colspan"],ze={class:"empty-state"},Ee={__name:"EditUiTable",props:{modelValue:{type:Array,default:()=>[]},columns:{type:Array,required:!0},size:{type:String,default:"medium",validator:_=>["small","medium","large"].includes(_)},bordered:{type:Boolean,default:!0},striped:{type:Boolean,default:!0}},emits:["update:modelValue","save","cancel"],setup(_,{emit:T}){const m=_,D=T,u=b(!1),c=b([]),d=b([]),y=b(-1),N=b(null),R=x(()=>[`ui-table-default--${m.size}`,{"ui-table-default--bordered":m.bordered,"ui-table-default--striped":m.striped,"ui-table-default--hover":!0,"ui-table-default--edit-mode":u.value}]),U=x(()=>c.value.length>0&&d.value.length===c.value.length),w=x(()=>{let n=m.columns.length;return u.value&&(n+=2),n}),C=()=>{c.value=JSON.parse(JSON.stringify(m.modelValue))},A=()=>{u.value=!0,C(),d.value=[]},M=()=>{u.value=!1,d.value=[],C(),D("cancel")},O=()=>{u.value=!1,d.value=[],D("update:modelValue",[...c.value]),D("save",[...c.value])},E=()=>{const n={};m.columns.forEach(e=>{n[e.key]=e.defaultValue||""}),n.id=Date.now(),c.value.push(n)},I=()=>{d.value.length!==0&&confirm(`선택된 ${d.value.length}개 행을 삭제하시겠습니까?`)&&(c.value=c.value.filter((n,e)=>{const i=n.id||e;return!d.value.includes(i)}),d.value=[])},$=n=>{const e=d.value.indexOf(n);e>-1?d.value.splice(e,1):d.value.push(n)},q=()=>{U.value?d.value=[]:d.value=c.value.map((n,e)=>n.id||e)},F=(n,e)=>{const i=n[e.key];if(e.type==="select"&&e.options){const s=e.options.find(p=>p.value===i);return s?s.label:i}return i||""},J=(n,e)=>{y.value=n,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.outerHTML)},L=(n,e)=>{y.value!==n&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},H=(n,e)=>{if(e.preventDefault(),y.value!==-1&&y.value!==n){const i=c.value.splice(y.value,1)[0];c.value.splice(n,0,i)}},j=()=>{y.value=-1};return K(()=>m.modelValue,()=>{u.value||C()},{deep:!0,immediate:!0}),(n,e)=>{const i=G;return a(),l("div",X,[o("div",Y,[u.value?(a(),l("div",ee,[o("div",te,[o("button",{onClick:M,class:"btn btn-secondary"},[h(i,{name:"mdi:close",size:"16"}),e[1]||(e[1]=z(" 취소 "))]),o("button",{onClick:O,class:"btn btn-success"},[h(i,{name:"mdi:check",size:"16"}),e[2]||(e[2]=z(" 저장 "))])]),o("div",le,[o("button",{onClick:E,class:"btn btn-icon",title:"행 추가"},[h(i,{name:"mdi:plus",size:"16"})]),o("button",{onClick:I,class:"btn btn-icon btn-danger",disabled:d.value.length===0,title:"선택된 행 삭제"},[h(i,{name:"mdi:trash-can",size:"16"})],8,ae)])])):(a(),l("div",Z,[o("button",{onClick:A,class:"btn btn-primary"},[h(i,{name:"mdi:pencil",size:"16"}),e[0]||(e[0]=z(" 편집 "))])]))]),o("div",se,[o("table",{class:B(["ui-table-default",R.value])},[o("colgroup",null,[u.value?(a(),l("col",ne)):v("",!0),u.value?(a(),l("col",oe)):v("",!0),(a(!0),l(k,null,f(_.columns,s=>(a(),l("col",{key:s.key,style:P({width:s.width})},null,4))),128))]),o("thead",ue,[o("tr",null,[u.value?(a(),l("th",de,[o("input",{type:"checkbox",checked:U.value,onChange:q,class:"table-checkbox"},null,40,ie)])):v("",!0),u.value?(a(),l("th",ce)):v("",!0),(a(!0),l(k,null,f(_.columns,s=>(a(),l("th",{key:s.key},S(s.label),1))),128))])]),o("tbody",{class:"ui-table-default__body",ref_key:"tableBody",ref:N},[(a(!0),l(k,null,f(c.value,(s,p)=>(a(),l("tr",{key:s.id||p,class:B({selected:d.value.includes(s.id||p),dragging:y.value===p}),onDragstart:t=>J(p,t),onDragover:Q(t=>L(p,t),["prevent"]),onDrop:t=>H(p,t),onDragend:j,draggable:u.value},[u.value?(a(),l("td",pe,[o("input",{type:"checkbox",checked:d.value.includes(s.id||p),onChange:t=>$(s.id||p),class:"table-checkbox"},null,40,ve)])):v("",!0),u.value?(a(),l("td",me,[o("div",ye,[h(i,{name:"mdi:drag-vertical",size:"16"})])])):v("",!0),(a(!0),l(k,null,f(_.columns,t=>(a(),l("td",{key:t.key,class:"data-cell"},[u.value?(a(),l("div",_e,[t.type==="text"||!t.type?g((a(),l("input",{key:0,"onUpdate:modelValue":r=>s[t.key]=r,type:"text",class:"edit-input",placeholder:t.placeholder||""},null,8,be)),[[V,s[t.key]]]):t.type==="number"?g((a(),l("input",{key:1,"onUpdate:modelValue":r=>s[t.key]=r,type:"number",class:"edit-input",placeholder:t.placeholder||""},null,8,ke)),[[V,s[t.key],void 0,{number:!0}]]):t.type==="email"?g((a(),l("input",{key:2,"onUpdate:modelValue":r=>s[t.key]=r,type:"email",class:"edit-input",placeholder:t.placeholder||""},null,8,fe)),[[V,s[t.key]]]):t.type==="date"?g((a(),l("input",{key:3,"onUpdate:modelValue":r=>s[t.key]=r,type:"date",class:"edit-input"},null,8,ge)),[[V,s[t.key]]]):t.type==="select"?g((a(),l("select",{key:4,"onUpdate:modelValue":r=>s[t.key]=r,class:"edit-select"},[e[3]||(e[3]=o("option",{value:""},"선택하세요",-1)),(a(!0),l(k,null,f(t.options,r=>(a(),l("option",{key:r.value,value:r.value},S(r.label),9,De))),128))],8,Ve)),[[W,s[t.key]]]):v("",!0)])):(a(),l("span",he,S(F(s,t)),1))]))),128))],42,re))),128)),c.value.length===0?(a(),l("tr",Ce,[o("td",{colspan:w.value,class:"text-center"},[o("div",ze,[h(i,{name:"mdi:table-remove",size:"48",class:"empty-icon"}),e[4]||(e[4]=o("p",{class:"empty-message"},"데이터가 없습니다.",-1)),u.value?(a(),l("button",{key:0,onClick:E,class:"btn btn-primary"}," 첫 번째 행 추가 ")):v("",!0)])],8,xe)])):v("",!0)],512)],2)])])}}};export{Ee as default};
